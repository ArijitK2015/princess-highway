<?php
/**
 * iKantam
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade InstagramConnect to newer
 * versions in the future.
 *
 * @category    Ikantam
 * @package     Ikantam_InstagramConnect
 * @copyright   Copyright (c) 2012 iKantam LLC (http://www.ikantam.com)
 * @license     http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
?>
<?php
if (!$this->showInstagramImages()) {
    return;
}
$currentList = $this->getCurrentList();
$limit    = $this->getData('limit') ? $this->getData('limit') : $currentList->getLimit();
$image_size       = $currentList->getImageSize();
$style            = $currentList->getStyle();
$header_text      = $currentList->getTitle();
$header_link      = $currentList->getLink();

if ($header_link)
    $header_text = "<a href=$header_link>$header_text</a>";
?>

<div class="instagram-title"><?php echo $header_text ?></div>
<div class="instagram-view" id="instagram-widget"></div>

<script type="text/javascript">
    var images = <?php echo $this->getInstagramGalleryImages($limit); ?>;

    function renderPhoto(position) {
        var image = images[position];
        var html = "<img src='" + image.standard_resolution_url + "'/><div class=\"instagram-caption\">" + image.caption_text +<?php if ($this->getCurrentList()->getDisplayLikes()): ?>" " + image.likes +" likes" +<?php endif; ?> "</div>";
        if (image.link) html = "<a target=\"_blank\" rel=\"noopener noreferrer\" href='" + image.link + "'>" + html + "</a>";
        html = "<div class=\"item\">" + html + "</div>";
        return html;
    }

    function renderArea() {
        var content = "";
        for (var i = 0, len = images.length; i < len; i++) {
            content += renderPhoto(i);
        }
        document.getElementById('instagram-widget').innerHTML = content;
    }

    renderArea();
</script>

<style type="text/css">
    .instagram-view div:last-child{
        margin-right:0px;
    }
    <?php echo $style ?>
</style>